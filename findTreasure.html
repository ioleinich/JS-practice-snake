<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script src="https://code.jquery.com/jquery-2.1.0.js"></script>
	<title>Treasure</title>
	<style>
		body {
			text-align: center;
		}
		.hint {
			width: 30%;
			float: right;
			border: 1px solid black;
			border-radius: 10px;
			background-color: #efefef;
		}
		.picture {
			width: 70%;
			margin-right: 100px;
		}
		.texth2 {
			font: 1.5em;
			border-top-left-radius: 10px;
			border-top-right-radius: 10px;
			margin: 0;
			padding: 10px;
			
		}
		#distance {
			font: 2em bold;
		}
		

	</style>
</head>
<body>
	<h1 id="main">Найди сокровища!</h1>
	<div>
		<div class="hint">
			<p class = "texth2">Насколько далеко Вы от клада:</p>
			<p id="distance"></p>
		</div> 
		<div class = "picture">
			<canvas id ="map" width=500 height=400></canvas>
		</div>
	</div>

	
	<script> 
		
		var mapCanvas = document.getElementById("map");
		var ctx = mapCanvas.getContext('2d');
		var img1 = new Image();
		img1.src = "http://cdn8.openculture.com/wp-content/uploads/2015/11/01225913/NarniaMap-e1324285473899.jpg"
		img1.onload = function() {
			ctx.drawImage(img1, 0, 0);
		};
		var getRandomNumber = function(size) {
			return Math.floor(Math.random()*size);
		};
		var getDistance = function(event, target) {
			var diffX = event.offsetX - target.x;
			var diffY = event.offsetY - target.y;
			return Math.sqrt(diffX*diffX + diffY*diffY);
		};
		var getDistanceHint = function(distance) {
			if (distance<50) {
			return "Вы чувствуете запах золота!";
			} else if  (distance <100) {
			return "Уже близко";
			} else if (distance<200) {
			return "Вы на верном пути";
			} else {
			return "Очень далеко";
			}
		};
		var width = 500;
		var height = 400;
		var clicks = 0;
		var target = {
		x: getRandomNumber(width),
		y: getRandomNumber(height)
		};
		var drawCircle = function (distance) {
			if (distance < 50) {
				ctx.fillStyle = "green";	
			} else if  (distance < 100) {
				ctx.fillStyle = "yellow";
			} else if (distance < 200) {
				ctx.fillStyle = "blue";
			} else {
				ctx.fillStyle = "black";
			}
			var x = event.offsetX;
			var y = event.offsetY;
			ctx.beginPath();
			ctx.arc(x, y, 5, 0, Math.PI * 2, false);
			ctx.fill();
		};

		var drawCross = function () {
			ctx.strokeStyle = "red";	
			ctx.lineWidth = 4;
			var x = event.offsetX;
			var y = event.offsetY;
			ctx.beginPath();
			ctx.moveTo(x-7, y-7);
			ctx.lineTo(x+7, y+7);
			ctx.moveTo(x+7, y-7);
			ctx.lineTo(x-7, y+7);
			ctx.stroke();
		};

		$("#map").click(function(event) {
		clicks++;
		var distance = getDistance(event, target);
		drawCircle(distance);
		var distanceHint = getDistanceHint(distance);
		$("#distance").text(distanceHint);
		if (distance < 30) {
			drawCross();
			alert("Клад найден! Победа");
		}
		});
 	
	</script>
</body>
</html>